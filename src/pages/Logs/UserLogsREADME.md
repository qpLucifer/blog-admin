# 用户操作日志管理模块

## 概述

用户操作日志管理模块提供了简化的用户操作记录查看、分析和管理功能，专注于记录用户的关键操作信息。

## 功能特性

### 1. 操作日志查看

- 用户登录/登出记录
- 模块增删改查操作记录
- IP地址和用户代理信息
- 操作时间和状态记录

### 2. 多条件搜索

- 按用户名搜索
- 按操作类型筛选（登录、登出、创建、更新、删除、查看）
- 按模块筛选（认证、用户管理、博客管理等）
- 按时间范围筛选
- 按IP地址搜索

### 3. 统计分析

- 今日操作数量统计
- 近7天操作趋势
- 主要操作模块分析
- 主要操作类型分析

### 4. 日志管理

- 日志导出（CSV格式）
- 过期日志清理
- 分页查看和排序

## 技术实现

### 组件结构

```
src/pages/Logs/
├── UserLogs.tsx       # 用户日志主页面
├── index.module.css   # 样式文件
└── README.md          # 说明文档
```

### API接口

- `GET /api/logs/list` - 获取用户操作日志列表
- `GET /api/logs/stats` - 获取日志统计信息
- `GET /api/logs/export` - 导出日志数据
- `DELETE /api/logs/clean` - 清理过期日志

### 数据类型

```typescript
interface UserLog {
  id: number;
  user_id?: number;
  username?: string;
  action: 'login' | 'logout' | 'create' | 'update' | 'delete' | 'view';
  module: 'auth' | 'user' | 'blog' | 'comment' | 'tag' | 'role' | 'menu' | 'daySentence' | 'upload';
  target_id?: number;
  target_name?: string;
  ip_address?: string;
  user_agent?: string;
  details?: string;
  status: 'success' | 'failed' | 'error';
  created_at: string;
}
```

## 使用说明

### 查看操作日志

1. 进入"系统管理" -> "日志管理"
2. 查看统计卡片了解整体情况
3. 使用搜索条件筛选特定日志
4. 在表格中查看详细的操作记录

### 搜索和筛选

1. **用户名搜索**：输入用户名进行模糊搜索
2. **操作类型**：选择特定的操作类型（登录、创建、更新等）
3. **模块筛选**：选择特定的功能模块
4. **时间范围**：选择开始和结束日期
5. **IP地址**：输入IP地址进行搜索

### 日志管理

1. **导出日志**：点击"导出"按钮下载CSV格式的日志文件
2. **清理日志**：点击"清理日志"删除30天前的记录
3. **刷新数据**：点击"刷新"获取最新的日志记录

### 查看详情

- 点击"查看详情"按钮可以查看操作的详细信息（JSON格式）
- 详情包含操作的具体参数和上下文信息

## 记录的操作类型

### 认证相关

- **登录**：用户登录成功/失败
- **登出**：用户主动登出
- **注册**：新用户注册

### 用户管理

- **创建用户**：管理员创建新用户
- **更新用户**：修改用户信息
- **删除用户**：删除用户账号

### 内容管理

- **博客操作**：创建、编辑、删除博客文章
- **评论管理**：审核、删除评论
- **标签管理**：创建、修改、删除标签
- **每日一句**：添加、编辑、删除每日一句

### 系统管理

- **角色管理**：创建、修改角色权限
- **菜单管理**：配置系统菜单
- **文件上传**：图片和文件上传记录

## 注意事项

1. 日志记录是异步的，不会影响主业务流程
2. 清理日志操作不可恢复，请谨慎操作
3. 导出功能限制最多10000条记录
4. 详情信息以JSON格式存储，包含操作的完整上下文
5. IP地址支持IPv4和IPv6格式
